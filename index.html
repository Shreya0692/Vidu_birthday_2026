(function vibeMixer(){
  const tagButtons = [...document.querySelectorAll("#vibeTags .tag")];
  const msgEl = document.getElementById("vibeMessage");
  const randomBtn = document.getElementById("vibeRandomBtn");
  const clearBtn = document.getElementById("vibeClearBtn");

  const lines = {
    udaipur: [
      "Udaipur looks prettier when youâ€™re smiling ğŸ’™",
      "Queen energyâ€¦ and Udaipur is the kingdom ğŸ‘‘",
      "From Udaipur to the world: Vidu is unstoppable âœ¨"
    ],
    cafinal: [
      "CA Final mode: ON. Confidence mode: ON. Youâ€™ve got this ğŸ’™",
      "Youâ€™re not just studying â€” youâ€™re building your future.",
      "Disciplined. Sharp. Calm. Thatâ€™s your CA Final vibe."
    ],
    pizza: [
      "Pizza is proof that life wants you to be happy ğŸ•",
      "Extra cheese for extra celebration ğŸ˜„",
      "A slice for you, a slice for your success."
    ],
    dessert: [
      "Dessert is not optional today. Itâ€™s required ğŸ°",
      "Sweet tooth, sweet heart â€” both undefeated ğŸ’™",
      "A dessert break = a power-up."
    ],
    season: [
      "Late gifts = birthday season extended. Scientific fact ğŸ",
      "Your birthday isnâ€™t a day. Itâ€™s a whole era ğŸ’™",
      "We celebrate nowâ€¦ and again when the gifts arrive ğŸ˜Œ"
    ]
  };

  function getActiveTags(){
    return tagButtons.filter(b => b.classList.contains("active")).map(b => b.dataset.tag);
  }

  function updateMessage(){
    const active = getActiveTags();
    if(active.length === 0){
      msgEl.textContent = "Tap a few vibes above ğŸ’™";
      return;
    }

    // Build a fun combined message
    const picked = active.map(k => {
      const arr = lines[k] || [];
      return arr[Math.floor(Math.random()*arr.length)];
    });

    msgEl.textContent = picked.join("  â€¢  ");
  }

  tagButtons.forEach(btn => {
    btn.addEventListener("click", () => {
      btn.classList.toggle("active");
      updateMessage();
    });
  });

  randomBtn?.addEventListener("click", () => {
    // randomly toggle 2â€“4 tags
    tagButtons.forEach(b => b.classList.remove("active"));
    const n = 2 + Math.floor(Math.random()*3);
    const shuffled = tagButtons.slice().sort(()=>Math.random()-0.5);
    shuffled.slice(0, n).forEach(b => b.classList.add("active"));
    updateMessage();
  });

  clearBtn?.addEventListener("click", () => {
    tagButtons.forEach(b => b.classList.remove("active"));
    updateMessage();
  });

  updateMessage();
})();
